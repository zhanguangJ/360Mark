"use strict";!function(){var n;function i(t){var e=($(t).parent().find(".ng-pristine").val()*$(t).parent().parent().prev().prev().text().slice(1)).toFixed(2);$(t).parent().parent().next().html("￥ "+e),c()}loginResgin(),window.onresize=window.onscroll=function(){toTop()},new Promise(function(e){$.ajax({type:"get",url:"/360Mark/src/api/main.php",async:!0,data:{id:55,time:new Date},success:function(t){e(t)}})}).then(function(t){var e=JSON.parse(t);$html=e.map(function(t){return'<li data-name="'+t.name+'" class="">\n                            <div class="sug-item">\n                                '+t.name+'\n                            </div>\n                            <div class="desc">约有'+t.sum+"件</div>\n                        </li>"}).join(""),$(".__mall_suggest__").html($html)}).then(function(){!function(){$(".text").click(function(t){$(".__mall_suggest__").css("display","block"),t.stopPropagation()}),$(".__mall_suggest__").on("click","li",function(){var t=$(this).attr("data-name");window.open("/360Mark/src/html/list.html?"+t)});var n=-1,i=$(".__mall_suggest__ li").size();$(document).ready(function(){$(".text").keydown(function(t){if(40===t.keyCode){n++;for(var e=0;e<i;e++)$(".__mall_suggest__ li").eq(e).removeClass("active");i-1<n&&(n=0),$val=$(".__mall_suggest__ li").eq(n).children("div").eq(0).html().trim(),$(".text").attr("placeholder",""),$(".text").val($val),$(".__mall_suggest__ li").eq(n).addClass("active")}if(38===t.keyCode){for(n--,e=0;e<i;e++)$(".__mall_suggest__ li").eq(e).removeClass("active");n<0&&(n=i-1),$val=$(".__mall_suggest__ li").eq(n).children("div").eq(0).html().trim(),$(".text").attr("placeholder",""),$(".text").val($val),$(".__mall_suggest__ li").eq(n).addClass("active")}if(13===t.keyCode){var a=$(".__mall_suggest__ li").eq(n).children("div").eq(0).html().trim();window.open("/360Mark/src/html/list.html?"+a)}})}),$(document).click(function(){$(".__mall_suggest__").css("display","none"),$(".text").attr("placeholder","360儿童手表"),$(".text").val("")}),$(".search").click(function(){var t=$(".text").attr("placeholder")+$(".text").val();window.open("../html/list.html?"+t.trim())})}()}),n=getCookie("username"),new Promise(function(e){$.ajax({type:"get",url:"/360Mark/src/api/order.php",data:{username:n,time:new Date},success:function(t){e(t)}})}).then(function(t){var e=t.replace(/\}(.+?)\{/g,"},{");e||(e="{"+e+"}");var a=JSON.parse(e);a.length?$html=a.map(function(t){return'<tr class="ng-scope goods" data-id="'+t.id+'">\n                                <td class="col1">\n                                    <span><input type="checkbox" /></span>\n                                </td>\n                                <td class="col2">\n                                    <a href="" target="_blank">\n                                        <img class="item-image" src="../img/'+t.title+t.bigimg+'.jpg"/>\n                                    </a>\n                                </td>\n                                <td class="col3">\n                                    <a href="" target="_blank">\n                                        '+t.name+'\n                                    </a>\n                                </td>\n                                <td class="col4 ng-binding">￥'+t.price+'.00</td>\n                                <td class="col7">\n                                    <a href="javascript:;" class="delete" data-id="'+t.id+'">X</a>\n                                </td>                                \n                            </tr>'}).join(""):$html="<p>快去购买商品吧</p>",$(".cartbody").html($html),$.ajax({type:"get",url:"/360Mark/src/api/showcart.php",data:{username:n,time:new Date},success:function(t){for(var e=JSON.parse(t),a=0;a<e.length;a++)$ht='<td class="col5 center ng-scope">\n                                    <div class="number-editor">\n                                        <a href="javascript:;" class=\'cutnum\'>-</a>\n                                        <input type="text" class="ng-pristine ng-valid" value="'+e[a].num+'" />\n                                        <a href="javascript:;" class=\'addnum\'>+</a>\n                                    </div>\n                                </td>\n                                <td class="total-price col6 ng-binding">￥'+e[a].totalprice+".00</td>",$(".goods").eq(a).append($ht)}})}),$(".cartbody").on("click",".addnum",function(){var t=getCookie("username"),e=$(this).prev().val(),a=$(this).parent().parent().parent().attr("data-id");10<++e&&(e=10),$(this).prev().val(e),i($(this)),c();var n=$(this).parent().parent().next().html().slice(2);$.ajax({type:"get",url:"/360Mark/src/api/updatecart.php",data:{num:e,username:t,gId:a,totalprice:n,time:new Date},success:function(t){console.log(t)}})}),$(".cartbody").on("click",".cutnum",function(){var t=getCookie("username"),e=$(this).next().val(),a=$(this).parent().parent().parent().attr("data-id");e--,console.log(e),e<=1&&(e=1),$(this).next().val(e),i($(this)),c();var n=$(this).parent().parent().next().html().slice(2);$.ajax({type:"get",url:"/360Mark/src/api/updatecart.php",data:{num:e,username:t,gId:a,totalprice:n,time:new Date},success:function(t){console.log(t)}})}),$(".cartbody").on("keyup",".ng-pristine",function(){var t=getCookie("username"),e=$(this).val(),a=$(this).parent().parent().parent().attr("data-id");10<e?e=10:e<=1&&(e=1),$(this).val(e),i($(this)),c();var n=$(this).parent().parent().next().html().slice(2);$.ajax({type:"get",url:"/360Mark/src/api/updatecart.php",data:{num:e,username:t,gId:a,totalprice:n,time:new Date},success:function(t){console.log(t)}})}),$(".cartbody").on("click",".delete",function(){if(confirm("确定删除？")){$(this).parent().parent().remove();var t=getCookie("username"),e=$(this).attr("data-id");$.ajax({type:"get",url:"/360Mark/src/api/delete.php",data:{username:t,gid:e,time:new Date},success:function(t){1==t?ssCart():alert("删除失败")}})}c()}),$(".icon-toggle").click(function(){$(".ng-hide").toggleClass("area")}),$(".statistics input").on("click",function(){var t=$(".statistics input").prop("checked");$(".col1 input").prop("checked",t),c()}),$(".backtoshopping").click(function(){window.location.href="/360Mark/index.html"}),$(".cartbody").on("click",".col1 input",function(){$(".col1 input:checked").size()==$(".col1 input").size()?$(".statistics input").prop("checked",!0):$(".statistics input").prop("checked",!1),c()});var s=[];function c(){$(".col1 input").each(function(t,e){$(e).prop("checked")&&s.push(t)});var e=0,a=0;s.forEach(function(t){e+=1*$(".ng-pristine").eq(t).val(),a+=1*$(".total-price").eq(t).text().slice(1)}),$ht=' 已选择\n                <strong class="ng-binding">'+e+'</strong>\n                件,共\n                <strong class="ng-binding">'+e+"</strong>\n                件",$ht2='合计:\n                    <strong class="ng-binding">\n                        <span class="unit">￥</span>\n                        '+a.toFixed(2)+"\n                    </strong>",$("#allnum").html($ht),$(".main").html($ht2),s=[]}c()}();